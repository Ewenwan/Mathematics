%1998年全国大学生数学建模竞赛A题：收益与风险 模型求解
%参看《数学的实践与认识》1999年第一期，p39-42
%另见 jm98a2,jm983,jm983fun

clear;close;
%问题一投资目标曲线
n=4;
r=[28 21 23 25 5]'/100;
q=[2.5 1.5 5.5 2.6 0]'/100;
p=[1 2 4.5 6.5 0]'/100;
u=[103 198 52 40 100]';
lemda=0;
for i=1:11
  c=[(1-lemda)*(p-r);lemda];
  A1=[(1+p)', 0];
  A2=[diag(q(1:n)),zeros(n,1),-ones(n,1)];
  A=[A1;A2];
  b=[1;zeros(n,1)];
  vlb=zeros(n+2,1);
  x=lp(c,A,b,vlb,[],[],1);
  y=-(p-r)'*x(1:(n+1));
  goal=[y x(n+2)];
  lemda=lemda+0.1;
  s(:,i)=[x(1:(n+1));goal'];
end
s
subplot(1,2,1);plot(0:0.1:1,s(n+2,:),'k',0:0.1:1,s(n+3,:),'k*:');
title('投资目标曲线(n=4)');
xlabel('谨慎程度');legend('收益 ','风险');

%问题二投资目标曲线
clear;
n=15;
r=[9.6 18.5 49.4 23.9 8.1 14 40.7 31.2 33.6 36.8 11.8 9 35 9.4 15 5]'/100;
q=[42 54 60 42 1.2 39 68 33.4 53.3 40 31 5.5 46 5.3 23 0]'/100;
p=[2.1 3.2 6 1.5 7.6 3.4 5.6 3.1 2.7 2.9 5.1 5.7 2.7 4.5 7.6 0]'/100;
u=[181 407 428 549 270 397 178 220 475 248 195 320 267 328 131 0]';
lemda=0;
for i=1:11
  c=[(1-lemda)*(p-r);lemda];
  A1=[(1+p)', 0];
  A2=[diag(q(1:n)),zeros(n,1),-ones(n,1)];
  A=[A1;A2];
  b=[1;zeros(n,1)];
  vlb=zeros(n+2,1);
  x=lp(c,A,b,vlb,[],[],1);
  y=-(p-r)'*x(1:(n+1));
  goal=[y x(n+2)];
  lemda=lemda+0.1;
  s(:,i)=[x(1:(n+1));goal'];
end
s
subplot(1,2,2);plot(0:0.1:1,s(n+2,:),'k',0:0.1:1,s(n+3,:),'k*:');
title('投资目标曲线(n=15)');
xlabel('谨慎程度');legend('收益','风险');

